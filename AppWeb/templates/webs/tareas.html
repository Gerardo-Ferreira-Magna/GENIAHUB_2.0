{% extends 'webs/base.html' %}
{% load static %}

{% block title %}GENIAHUB | tareas{% endblock %}

{% block content %}

<!-- Fuente -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="{% static 'css/estilo_panel.css' %}">





<div class="container-fluid px-4 py-4">

  <!-- Encabezado -->
  <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
    <h2 class="fw-bold section-title mb-2 text-primary"><i class="bi bi-clipboard-check me-2 text-primary"></i>Panel de Tareas</h2>
    <button class="btn btn-primary rounded-pill px-4">
      <i class="bi bi-plus-circle me-2"></i>Nueva Tarea
    </button>
  </div>
  </div>

  <!-- Tabla de Usuarios y Progreso -->
  <div class="card p-3 mb-5">
    <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap">
      <h5 class="fw-bold mb-0">Usuarios y Progreso de Tareas</h5>
      <div class="d-flex align-items-center">
        <input id="userSearchInput" type="text" class="form-control form-control-sm" placeholder="Buscar usuario o tarea...">
      </div>
    </div>

    <div class="table-responsive">
      <table class="table align-middle table-hover" id="usersTable">
        <thead class="table-light">
          <tr>
            <th>#</th><th>Usuario</th><th>Tarea / Proceso</th><th>Proyecto</th><th>Estado</th>
            <th>Prioridad</th><th>Cronograma</th><th>Progreso</th><th>%</th><th>Comentarios</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>01</td>
            <td>
              <div class="d-flex align-items-center">
                <img src="{% static 'img/Yesenia.jpg' %}" class="rounded-circle me-2" width="35" height="35">
                <div><strong>Yesenia Catalan</strong><br><small class="text-muted">Líder de Proyecto</small></div>
              </div>
            </td>
            <td>Validar requerimientos del cliente</td>
            <td>Proyecto Alpha</td>
            <td><span class="badge bg-success">Completado</span></td>
            <td><span class="badge bg-primary">Alta</span></td>
            <td>01 - 05 Oct</td>
            <td><div class="progress"><div class="progress-bar bg-primary" style="width:100%"></div></div></td>
            <td>100%</td>
            <td><small class="text-muted">Revisión completada y aprobada.</small></td>
          </tr>
          <tr>
            <td>02</td>
            <td>
              <div class="d-flex align-items-center">
                <img src="{% static 'img/Gerardo.jpg' %}" class="rounded-circle me-2" width="35" height="35">
                <div><strong>Gerardo Ferreira</strong><br><small class="text-muted">Analista</small></div>
              </div>
            </td>
            <td>Desarrollar módulo de autenticación</td>
            <td>Proyecto Beta</td>
            <td><span class="badge bg-warning text-dark">En Progreso</span></td>
            <td><span class="badge bg-danger">Crítica</span></td>
            <td>05 - 20 Oct</td>
            <td><div class="progress"><div class="progress-bar bg-primary" style="width:70%"></div></div></td>
            <td>70%</td>
            <td><small class="text-muted">Requiere revisión de endpoints API.</small></td>
          </tr>
          <tr>
            <td>03</td>
            <td>
              <div class="d-flex align-items-center">
                <img src="{% static 'img/Mauricio.jpg' %}" class="rounded-circle me-2" width="35" height="35">
                <div><strong>Mauricio Retamal</strong><br><small class="text-muted">UX Designer</small></div>
              </div>
            </td>
            <td>Actualizar prototipos de interfaz</td>
            <td>Proyecto Gamma</td>
            <td><span class="badge bg-secondary">Pendiente</span></td>
            <td><span class="badge bg-warning text-dark">Media</span></td>
            <td>10 - 18 Oct</td>
            <td><div class="progress"><div class="progress-bar bg-primary" style="width:35%"></div></div></td>
            <td>35%</td>
            <td><small class="text-muted">Esperando validación del cliente.</small></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<script>
  const rowsPerPage = 5;
  let currentPage = 1;
  const table = document.getElementById("projectsTable");
  const rows = table.querySelectorAll("tbody tr");
  const pagination = document.getElementById("pagination");
  const searchInput = document.getElementById("searchInput");

  function displayTable() {
    const start = (currentPage - 1) * rowsPerPage;
    const end = start + rowsPerPage;
    rows.forEach((row, i) => {
      row.style.display = i >= start && i < end ? "" : "none";
    });
  }

  function updatePagination() {
    const totalPages = Math.ceil(rows.length / rowsPerPage);
    pagination.innerHTML = "";
    for (let i = 1; i <= totalPages; i++) {
      const li = document.createElement("li");
      li.className = `page-item ${i === currentPage ? "active" : ""}`;
      li.innerHTML = `<a class="page-link" href="#">${i}</a>`;
      li.addEventListener("click", e => {
        e.preventDefault();
        currentPage = i;
        displayTable();
        updatePagination();
      });
      pagination.appendChild(li);
    }
  }

  searchInput.addEventListener("keyup", () => {
    const search = searchInput.value.toLowerCase();
    rows.forEach(row => {
      const text = row.textContent.toLowerCase();
      row.style.display = text.includes(search) ? "" : "none";
    });
  });

  const userSearchInput = document.getElementById("userSearchInput");
  const userRows = document.querySelectorAll("#usersTable tbody tr");
  userSearchInput.addEventListener("keyup", () => {
    const search = userSearchInput.value.toLowerCase();
    userRows.forEach(row => {
      const text = row.textContent.toLowerCase();
      row.style.display = text.includes(search) ? "" : "none";
    });
  });

  displayTable();
  updatePagination();
</script>

{% endblock %}